arguments:
    basicAuthorizationResolver: Innmind\HttpAuthentication\ViaBasicAuthorization\Resolver ?? $default.basicAuthorizationResolver
    authorizationResolver: Innmind\HttpAuthentication\ViaAuthorization\Resolver ?? $default.authorizationResolver
    formResolver: Innmind\HttpAuthentication\ViaForm\Resolver ?? $default.formResolver
    urlAuthorityResolver: Innmind\HttpAuthentication\ViaUrlAuthority\Resolver ?? $default.urlAuthorityResolver
    storage: Innmind\HttpAuthentication\ViaStorage\Storage ?? $default.storage

expose:
    authenticator: $validateAuthorizationHeader

services:
    validateAuthorizationHeader Innmind\HttpAuthentication\ValidateAuthorizationHeader:
        - $authenticator.storage

    any Innmind\HttpAuthentication\Any:
        - $authenticator.urlAuthority
        - $authenticator.basicAuthorization
        - $authenticator.authorization
        - $authenticator.form

    authenticator:
        urlAuthority Innmind\HttpAuthentication\ViaUrlAuthority:
            - $urlAuthorityResolver

        basicAuthorization Innmind\HttpAuthentication\ViaBasicAuthorization:
            - $basicAuthorizationResolver

        authorization Innmind\HttpAuthentication\ViaAuthorization:
            - $authorizationResolver

        form Innmind\HttpAuthentication\ViaForm:
            - $formResolver

        storage Innmind\HttpAuthentication\ViaStorage:
            - $any
            - $storage

    default:
        basicAuthorizationResolver Innmind\HttpAuthentication\ViaBasicAuthorization\NullResolver: []
        authorizationResolver Innmind\HttpAuthentication\ViaAuthorization\NullResolver: []
        formResolver Innmind\HttpAuthentication\ViaForm\NullResolver: []
        urlAuthorityResolver Innmind\HttpAuthentication\ViaUrlAuthority\NullResolver: []
        storage Innmind\HttpAuthentication\ViaStorage\NullStorage: []
